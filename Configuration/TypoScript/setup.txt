#############################
# plugin.tx_vidifrontend
#############################
plugin.tx_vidifrontend {
	view {
		templateRootPath = {$plugin.tx_vidifrontend.view.templateRootPath}
		partialRootPath = {$plugin.tx_vidifrontend.view.partialRootPath}
		layoutRootPath = {$plugin.tx_vidifrontend.view.layoutRootPath}
	}
	persistence {
		storagePid = {$plugin.tx_vidifrontend.persistence.storagePid}
	}

	settings {
#		storagePid {
#			request = 4218
#		}

		targetStorage = 2
		targetFolder = Requests/

	}
}

#############################
# plugin.tx_messenger
#############################
plugin.tx_messenger {
	settings {

		defaults {
				recipientName = BOBST website
				recipientEmail = webmaster.internet@bobst.com
		}

		request {
			# type = 1
			1 {
				# Corresponds to the uid of message template
				user {
					messageTemplateIdentifier = 1
				}
				admin {
					messageTemplateIdentifier = 2
				}
			}
			# type = 2
			2 {
				user {
					messageTemplateIdentifier = 3
				}
				admin {
					messageTemplateIdentifier = 4
				}
			}
			# type = 3
			3 {
				user {
					messageTemplateIdentifier = 5
				}
				admin {
					messageTemplateIdentifier = 6
				}
			}
			# type = 4
			4 {
				user {
					messageTemplateIdentifier = 7
				}
				admin {
					messageTemplateIdentifier = 8
				}
			}
			# type = 5
			5 {
				user {
					messageTemplateIdentifier = 9
				}
				admin {
					messageTemplateIdentifier = 10
				}
			}
			# type = 6
			6 {
				user {
					messageTemplateIdentifier = 11
				}
				admin {
					messageTemplateIdentifier = 12
				}
			}
			# type = 7
			7 {
				user {
					messageTemplateIdentifier = 13
				}
				admin {
					messageTemplateIdentifier = 14
				}
			}
			# type = 8
			8 {
				user {
					messageTemplateIdentifier = 15
				}
				admin {
					messageTemplateIdentifier = 16
				}
			}
			# type = 9
			9 {
				user {
					messageTemplateIdentifier = 17
				}
				admin {
					messageTemplateIdentifier = 18
				}
			}
			# type = 10
			10 {
				user {
					messageTemplateIdentifier = 17
				}
				admin {
					messageTemplateIdentifier = 18
				}
			}
		}
	}
}

#############################
# plugin.tx_quickform
#############################
plugin.tx_quickform {

	settings {
		# Tell to fetch the Quick Form Partials from lima instead of quick_form.
		partialExtensionKey = vidi_frontend
	}

	# The TS is used for validating an equipment according to his type.
	# Before introducing the validation definition here, I tried different approaches:
	# - annotation in class itself could not be used because some fields are mandatory for a type of equipment and not for other.
	#   We don't have some partial validation mechanism in Extbase in TYPO3 6.1
	# - eval => 'required'. As an approach, I could use the "eval" key from the TCA and introduces some validation upon that key.
	#   Unfortunately, the BE and FE does not have the same requirement.
	#
	validate {

		# Request
		request {

			default {
				first_name {
					required = 1
				}
				last_name {
					required = 1
				}
				country {
					required = 1
				}
				email {
					required = 1
				}
				is_privacy_statement_accepted {
					required = 1
				}
			}

			# Products request
			1 < plugin.tx_quickform.validate.request.default
			1 {
				is_already_customer {
					required = 1
				}
				process {
					required = 1
				}
				company {
					required = 1
				}
			}

			# Service request
			2 < plugin.tx_quickform.validate.request.default
			2 {
				is_already_customer {
					required = 1
				}
				activity {
					required = 1
				}
				process {
					required = 1
				}
				subject {
					required = 1
				}
				company {
					required = 1
				}
			}

			# Investors contact
			3 < plugin.tx_quickform.validate.request.default
			3 {
				company {
					required = 1
				}
			}

			# Job unsolicited application
			4 < plugin.tx_quickform.validate.request.default
			4 {
				company_target {
					required = 1
				}
				curriculum_vitae {
					required = 1
				}
				company {
					required = 1
				}
			}

			# Media contact
			5 < plugin.tx_quickform.validate.request.default
			5 {
				company {
					required = 1
				}
			}

			# Webmaster contact
			6 < plugin.tx_quickform.validate.request.default
			6 {
				subject_webmaster {
					required = 1
				}
			}

			# Events registration
			7 < plugin.tx_quickform.validate.request.default
			7 {
				is_already_customer {
					required = 1
				}
				activity_event {
					required = 1
				}
				process_main_interest {
					required = 1
				}
				visit_date {
					required = 1
				}
				company {
					required = 1
				}
			}

			# Job application
			8 < plugin.tx_quickform.validate.request.default
			8 {
				motivation_letter {
					required = 1
				}
				curriculum_vitae {
					required = 1
				}
			}

			# Company contact
			9 < plugin.tx_quickform.validate.request.default
			9 {
				company {
					required = 1
				}
			}

			# Events contact
			10 < plugin.tx_quickform.validate.request.default
			10 {
				company {
					NotEmpty = 1
				}
			}
		}
	}
}
